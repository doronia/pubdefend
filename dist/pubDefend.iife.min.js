!function(){"use strict";var n=window.pubDefend||window.pubdefend||{};n.state={o:!1},n.store={},n.t=[],n.i=[];var e={u:"pubdefend.com",l:"c",o:"ws",v:"ad_banner.js"},o={o:"___pd_ws",g:"___pd_gt",p:"___pd_ab"};var t="undefined"!=typeof window,r=t&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),i=(t&&document.createElement("p"),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent));function a(n){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function u(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var o=[],t=!0,r=!1,i=void 0;try{for(var a,u=n[Symbol.iterator]();!(t=(a=u.next()).done)&&(o.push(a.value),!e||o.length!==e);t=!0);}catch(n){r=!0,i=n}finally{try{t||null==u.return||u.return()}finally{if(r)throw i}}return o}(n,e)||c(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(n,e){if(n){if("string"==typeof n)return d(n,e);var o=Object.prototype.toString.call(n).slice(8,-1);return"Object"===o&&n.constructor&&(o=n.constructor.name),"Map"===o||"Set"===o?Array.from(n):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?d(n,e):void 0}}function d(n,e){(null==e||e>n.length)&&(e=n.length);for(var o=0,t=new Array(e);o<e;o++)t[o]=n[o];return t}var f=Object.entries?Object.entries:function(n){return Object.keys(n).reduce((function(e,o){return e.push([o,n[o]]),e}),[])};function l(n){for(var e,o,t,r=3&n.length,i=n.length-r,a=3432918353,u=461845907,c=0;c<i;c++)t=255&n.charCodeAt(c)|(255&n.charCodeAt(++c))<<8|(255&n.charCodeAt(++c))<<16|(255&n.charCodeAt(++c))<<24,++c,e=27492+(65535&(o=5*(65535&(e=(e^=t=(65535&(t=(t=(65535&t)*a+(((t>>>16)*a&65535)<<16)&4294967295)<<15|t>>>17))*u+(((t>>>16)*u&65535)<<16)&4294967295)<<13|e>>>19))+((5*(e>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);var d=i-1;switch(t=0,r){case 3:t^=(255&n.charCodeAt(d+2))<<16;break;case 2:t^=(255&n.charCodeAt(d+1))<<8;break;case 1:t^=255&n.charCodeAt(d)}return e^=t=(65535&(t=(t=(65535&t)*a+(((t>>>16)*a&65535)<<16)&4294967295)<<15|t>>>17))*u+(((t>>>16)*u&65535)<<16)&4294967295,e^=n.length,e=2246822507*(65535&(e^=e>>>16))+((2246822507*(e>>>16)&65535)<<16)&4294967295,e=3266489909*(65535&(e^=e>>>13))+((3266489909*(e>>>16)&65535)<<16)&4294967295,(e^=e>>>16)>>>0}var s=function(n,e){var o=window,t=o.screen,r=o.userAgent,i=o.language,a=o.languages,c=o.platform,d=o.hardwareConcurrency,s=o.deviceMemory,w=t.colorDepth,v=t.availHeight,g=t.availWidth,p=f(o.navigator.plugins).map((function(n){return u(n,2)[1].name})),y=(new Date).getTimezoneOffset(),m=Intl.DateTimeFormat().resolvedOptions().timeZone,b="ontouchstart"in window,h=function(){try{var n=document.createElement("canvas"),e=n.getContext("2d");return e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",4,17),n.toDataURL()}catch(n){return n}}(),S=window.doNotTrack||navigator.doNotTrack||navigator.msDoNotTrack||"m"in window.external?!("1"!=window.doNotTrack&&"yes"!=navigator.doNotTrack&&"1"!=navigator.doNotTrack&&"1"!=navigator.msDoNotTrack&&!window.external.m()):void 0,O=JSON.stringify({platform:c,hardwareConcurrency:d,deviceMemory:s,colorDepth:w,availWidth:g,availHeight:v,h:b,canvas:h}),A=JSON.stringify({userAgent:r,language:i,languages:a,platform:c,hardwareConcurrency:d,deviceMemory:s,plugins:p,colorDepth:w,availWidth:g,availHeight:v,S:y,O:m,h:b,canvas:h,doNotTrack:S}),_=l(O)+"."+l(A);if(!e)return _;e(_)}(),w=function(n){return"object"===a(n)&&function(n){return null!=n}(n)&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof String)&&!(n instanceof Number)};function v(n,e,o){var t=n.split(e);return t.slice(0,o-1).concat(t.length>=o?t.slice(o-1).join(e):[])}function g(n){if(n&&document.getElementById("log")){var e=document.createElement("li");e.className="text-small font-normal",e.style.cssText="color: #99b8fd";var o=document.createTextNode(n);e.appendChild(o),document.getElementById("log").appendChild(e)}}var p=n.t;function y(n,e,o){if(w(n))if(n[e]=o,w(o)){var t,r=function(n,e){var o;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(o=c(n))||e&&n&&"number"==typeof n.length){o&&(n=o);var t=0,r=function(){};return{s:r,n:function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}},e:function(n){throw n},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){o=n[Symbol.iterator]()},n:function(){var n=o.next();return a=n.done,n},e:function(n){u=!0,i=n},f:function(){try{a||null==o.return||o.return()}finally{if(u)throw i}}}}(f(o));try{for(r.s();!(t=r.n()).done;){var i=u(t.value,2);g(e+"::"+i[0]+": "+i[1])}}catch(n){r.e(n)}finally{r.f()}}else g(e+": "+o)}function m(e){var o=n.store,t=JSON.stringify(o);return e?btoa(t):o}function b(n,e){if(n){e=e||"none";var o,t=n;try{o=new CustomEvent(t,{detail:{payload:e}})}catch(n){(o=document.createEvent("CustomEvent")).initCustomEvent(t,!1,!1,{payload:e})}window.dispatchEvent(o)}}var h={A:function(n){var e,o=[];if(!n||!n.length)return o;for(e=0;e<n.length;e++)o.push(n[e]);return o},find:function(n){if(!document.querySelectorAll||!n)return[];var e=document.querySelectorAll(n);return this.A(e)},_:function(n){if(!n||!n.length)return[];var e,o,t=[];for(e=0;e<n.length;e++)o=this.find(n[e]),t=t.concat(o);return t=this.j(t)},C:function(n,e){if(!n||!e||!n.getElementsByTagName)return[];var o=n.getElementsByTagName(e);return this.A(o)}};var S=n.store,O=0,A=!1;function _(n){var e=window.googletag;function o(){return window.googletag.pubads().getSlots().map((function(n){return{id:n.getSlotElementId()}}))}O=o(),y(S,"gtag_slots",O.length),logger.log("googaltag:: slots count:",O),e.pubads().addEventListener("slotRenderEnded",j.bind(null,C),!1),n&&n(o())}function j(n,e){var t=e.slot,r=t.getSlotElementId();!function(n){if(!n)return!1;function e(n,e){return window.getComputedStyle?document.defaultView.getComputedStyle(n,null)[e]:n.currentStyle?n.currentStyle[e]:void 0}"0"!==e(n,"opacity")&&"none"!==e(n,"display")&&e(n,"visibility")}(document.getElementById(r));if(e.isEmpty,e.size,logger.log("googaltag:: Slot",t.getSlotElementId(),"finished rendering."),!A){var i=h.find('div[id*="google_ad"]');y(S,"gtag_impr",i.length),b(o.g,i.length),n&&n(i)}A=!0}var E,C=function(n){!function(n){if(Array.isArray)return Array.isArray;Array.isArray=function(n){return"[object Array]"===Object.prototype.toString.call(n)}}()};function I(){var n="wss://"+e.o+"."+e.u+"/ws",t="cid_"+parseInt(100*Math.random(),10),r=this;function i(){r.client.connect({onSuccess:a,onFailure:u,keepAliveInterval:30,useSSL:!0,timeout:3})}function a(){logger.log("pubdefend:: ws Connected"),r.client.subscribe(r.I,{qos:1}),b(o.o,"Connected")}function u(n){logger.log("Connect failed:"+n.errorMessage)}return r.I="test",r.client=new Paho.MQTT.Client(n,t),r.client.onMessageArrived=function(n){},r.client.onConnectionLost=function(n){0!==n.errorCode&&(logger.log("Connection lost:"+n.errorMessage),i())},i(),r.N=function(n,e,o,t){var i=function(n,e,o,t){var r=new Paho.MQTT.Message(e);return r.destinationName=n,r.qos=Number(o)||0,r.k=!!t,r}(n,e,o&&o.qos,o&&o.R);t&&(i.qos<1?setTimeout(t):(i.M=t,messageCache.push(i))),r.client.send(i)},r.T=function(n,e){if(n){var o=new Paho.MQTT.Message(n);o.destinationName=r.I,e&&setTimeout(e),r.client.send(o)}},r}n.P=m;var N,k=n.store;function x(n){y(k,"vid",s),y(k,"host",function(){for(var n,e=[{key:"?",index:0},{key:"://",index:1},{key:"//",index:1},{key:"/",index:0},{key:":",index:0}],o=0,t=e.length,r=location.hostname;o<t;o++)r=(n=v(r,e[o].key,2)).length>1?n[e[o].index]:n[0];return r}());var e=atob(function(n){var e=document.querySelector(n);if(null!=e)return{id:e.getAttribute("pd-prop"),options:e.getAttribute("pubdefend-opts")||"{}"}}("[pd-prop]").id),o=JSON.stringify(e);console.log(JSON.parse(o)),y(k,"pub",JSON.parse(o));var r=function(){if(t){var n=window.navigator.userAgent.toLowerCase();switch(!0){case n.indexOf("edge")>-1:return"Edge (EdgeHtml)";case n.indexOf("edg")>-1:return"Edge Chromium";case n.indexOf("opr")>-1&&!!window.opr:return"opera";case n.indexOf("chrome")>-1&&!!window.chrome:return"chrome";case n.indexOf("trident")>-1:return"IE";case n.indexOf("firefox")>-1:return"Firefox";case n.indexOf("safari")>-1:return"Safari";case n.indexOf("Opera")||n.indexOf("OPR")>-1:return"Opera";default:return"other"}}}();return y(k,"browser",r),y(k,"isMobile",i),n&&n("isReady"),"isReady"}t&&!r&&(!function(n){if(n&&window.console&&"function"==typeof console.log)window.logger={log:window.console.log.bind(console.log),error:window.console.error.bind(console.error),info:window.console.info.bind(console.info),warn:window.console.warn.bind(console.warn),group:window.console.group.bind(console.group),groupEnd:window.console.groupEnd.bind(console.groupEnd),debug:window.console.debug.bind(console.debug)};else{var e=function(){};window.logger={log:e,error:e,warn:e,info:e,group:e,groupEnd:e,debug:e}}}(n.debug),N=function(){var t,r,i,a;logger.log("pubdefend:: init.."),t=function(n){n&&logger.log("googaltag::",n)},r=5,i=window.googletag,a=setInterval((function(){i&&i.apiReady&&(logger.log("googaltag:: apiReady (#"+r+")"),clearInterval(a),_(t)),r<=0&&clearInterval(a),r-=1}),100),x((function(t){var r,i,a;function u(e,t){var r,i;e&&(console.log("pubdefend["+e+" Listener]:: ws",n.state[o.o]),n.state[e]=!0,n.state[o.o]&&(r=e,i=t.detail.payload,r||(p[r]=i),console.log("pubdefend[EventQueue]::",e,t.detail.payload)),window.removeEventListener(t.type,u,!1))}logger.log("pubdefend::",t),function(n){var o=e,t="https://"+o.l+"."+o.u+"/js/"+o.v,r=new XMLHttpRequest;r.open("HEAD",t,!0),r.onload=function(e){if(r.readyState===XMLHttpRequest.DONE){var o=r.status;if(0===o||o>=200&&o<400)return void(n&&n(!1))}},r.onerror=function(e){n&&n(!0)},r.send(null)}((function(e){e.toString()&&(y(k,"ab",e),n.state[o.p]=!0,b(o.p,e.toString()))})),logger.log("pubdefend:: Loading paho lib"),r="https://"+e.l+"."+e.u+"/js/mqttws31.min.js",i=function(){logger.info("pubdefend[ws]:: ready"),E=new I},(a=document.createElement("script")).type="text/javascript",a.src=r,a.readyState?a.onreadystatechange=function(){var n=this.readyState;"loaded"!==n&&"complete"!==n||(a.onreadystatechange=null,i&&i())}:i&&(a.onload=i),document.getElementsByTagName("head")[0].appendChild(a),window.addEventListener(o.g,u.bind(null,o.g),!1),window.addEventListener(o.p,u.bind(null,o.p),!1),window.addEventListener(o.o,(function(e){console.info("pubdefend[ws Listener]::",e.detail.payload),console.info("pubdefend[ws state]::",o.g,"isReady?",n.state.hasOwnProperty(o.g)),console.info("pubdefend[ws staet]::",o.p,"isReady?",n.state.hasOwnProperty(o.p)),console.table(n.state),n.state[o.o]=!0,logger.info(m()),E.T(JSON.stringify(m(!0))),console.table(n.store),logger.log("pubdefend[status]:: ws",n.state[o.o])}),!0)}))},"interactive"===document.readyState||"complete"===document.readyState?setTimeout(N,0):document.addEventListener("DOMContentLoaded",N))}();
