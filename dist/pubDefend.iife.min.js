!function(){"use strict";var n=window.pubDefend||window.pubdefend||{};n.state={},n.store={},n.t=[],n.o=[];var e={endpoints:{i:"pubdefend.com",u:"c",l:"ws",v:"ad_banner.js"},p:{l:"___pd_ws",g:"___pd_gt",m:"___pd_ab"},h:[]};var t="undefined"!=typeof window,r=t&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),o=(t&&document.createElement("p"),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent));function i(n){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function a(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],r=!0,o=!1,i=void 0;try{for(var a,u=n[Symbol.iterator]();!(r=(a=u.next()).done)&&(t.push(a.value),!e||t.length!==e);r=!0);}catch(n){o=!0,i=n}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return t}(n,e)||u(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(n,e){if(n){if("string"==typeof n)return c(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(n,e):void 0}}function c(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var d=Object.entries?Object.entries:function(n){return Object.keys(n).reduce((function(e,t){return e.push([t,n[t]]),e}),[])};function f(n){for(var e,t,r,o=3&n.length,i=n.length-o,a=3432918353,u=461845907,c=0;c<i;c++)r=255&n.charCodeAt(c)|(255&n.charCodeAt(++c))<<8|(255&n.charCodeAt(++c))<<16|(255&n.charCodeAt(++c))<<24,++c,e=27492+(65535&(t=5*(65535&(e=(e^=r=(65535&(r=(r=(65535&r)*a+(((r>>>16)*a&65535)<<16)&4294967295)<<15|r>>>17))*u+(((r>>>16)*u&65535)<<16)&4294967295)<<13|e>>>19))+((5*(e>>>16)&65535)<<16)&4294967295))+((58964+(t>>>16)&65535)<<16);var d=i-1;switch(r=0,o){case 3:r^=(255&n.charCodeAt(d+2))<<16;break;case 2:r^=(255&n.charCodeAt(d+1))<<8;break;case 1:r^=255&n.charCodeAt(d)}return e^=r=(65535&(r=(r=(65535&r)*a+(((r>>>16)*a&65535)<<16)&4294967295)<<15|r>>>17))*u+(((r>>>16)*u&65535)<<16)&4294967295,e^=n.length,e=2246822507*(65535&(e^=e>>>16))+((2246822507*(e>>>16)&65535)<<16)&4294967295,e=3266489909*(65535&(e^=e>>>13))+((3266489909*(e>>>16)&65535)<<16)&4294967295,(e^=e>>>16)>>>0}var l=function(n,e){var t=window,r=t.screen,o=t.userAgent,i=t.language,u=t.languages,c=t.platform,l=t.hardwareConcurrency,s=t.deviceMemory,v=r.colorDepth,w=r.availHeight,p=r.availWidth,g=d(t.navigator.plugins).map((function(n){return a(n,2)[1].name})),y=(new Date).getTimezoneOffset(),m=Intl.DateTimeFormat().resolvedOptions().timeZone,b="ontouchstart"in window,h=function(){try{var n=document.createElement("canvas"),e=n.getContext("2d");return e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",4,17),n.toDataURL()}catch(n){return n}}(),S=window.doNotTrack||navigator.doNotTrack||navigator.msDoNotTrack||"S"in window.external?!("1"!=window.doNotTrack&&"yes"!=navigator.doNotTrack&&"1"!=navigator.doNotTrack&&"1"!=navigator.msDoNotTrack&&!window.external.S()):void 0,A=JSON.stringify({platform:c,hardwareConcurrency:l,deviceMemory:s,colorDepth:v,availWidth:p,availHeight:w,A:b,canvas:h}),O=JSON.stringify({userAgent:o,language:i,languages:u,platform:c,hardwareConcurrency:l,deviceMemory:s,plugins:g,colorDepth:v,availWidth:p,availHeight:w,O:y,j:m,A:b,canvas:h,doNotTrack:S}),j=f(A)+"."+f(O);if(!e)return j;e(j)}(),s=function(n){return"object"===i(n)&&function(n){return null!=n}(n)&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof String)&&!(n instanceof Number)};function v(n,e,t){var r=n.split(e);return r.slice(0,t-1).concat(r.length>=t?r.slice(t-1).join(e):[])}function w(n){if(n&&document.getElementById("log")){var e=document.createElement("li");e.className="text-small font-normal",e.style.cssText="color: #99b8fd";var t=document.createTextNode(n);e.appendChild(t),document.getElementById("log").appendChild(e)}}var p=n.t;function g(n,e,t){if(s(n)&&e&&0!==e.length&&t&&0!==t.length)if(n[e]=t,s(t)){var r,o=function(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=u(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return a=n.done,n},e:function(n){c=!0,i=n},f:function(){try{a||null==t.return||t.return()}finally{if(c)throw i}}}}(d(t));try{for(o.s();!(r=o.n()).done;){var i=a(r.value,2);w(e+"::"+i[0]+": "+i[1])}}catch(n){o.e(n)}finally{o.f()}}else w(e+": "+t)}function y(e){var t=n.store,r=JSON.stringify(t);return e?btoa(r):t}function m(n,e){if(n){e=e||"none";var t,r=n;try{t=new CustomEvent(r,{detail:{payload:e}})}catch(n){(t=document.createEvent("CustomEvent")).initCustomEvent(r,!1,!1,{payload:e})}window.dispatchEvent(t)}}var b={_:function(n){var e,t=[];if(!n||!n.length)return t;for(e=0;e<n.length;e++)t.push(n[e]);return t},find:function(n){if(!document.querySelectorAll||!n)return[];var e=document.querySelectorAll(n);return this._(e)},C:function(n){if(!n||!n.length)return[];var e,t,r=[];for(e=0;e<n.length;e++)t=this.find(n[e]),r=r.concat(t);return r=this.I(r)},k:function(n,e){if(!n||!e||!n.getElementsByTagName)return[];var t=n.getElementsByTagName(e);return this._(t)}};var h=n.store,S=0,A=!1;function O(n){var e=window.googletag;S=window.googletag.pubads().getSlots().map((function(n){return{id:n.getSlotElementId()}})),g(h,"gs",S.length),logger.log("pubdefend[g]:: slots count:",S),e.pubads().addEventListener("slotRenderEnded",j.bind(null,C),!1),n&&n("listen")}function j(n,t){var r=t.slot,o=r.getSlotElementId();!function(n){if(!n)return!1;function e(n,e){return window.getComputedStyle?document.defaultView.getComputedStyle(n,null)[e]:n.currentStyle?n.currentStyle[e]:void 0}"0"!==e(n,"opacity")&&"none"!==e(n,"display")&&e(n,"visibility")}(document.getElementById(o));if(t.isEmpty,t.size,logger.log("pubdefend[g]:: Slot",r.getSlotElementId(),"finished rendering."),!A){var i=b.find('div[id*="google_ad"]');g(h,"gi",i.length),m(e.p.g,i.length),n&&n(i)}A=!0}var _,C=function(n){!function(n){if(Array.isArray)return Array.isArray;Array.isArray=function(n){return"[object Array]"===Object.prototype.toString.call(n)}}()};function E(){var n="wss://"+e.endpoints.l+"."+e.endpoints.i+"/ws",t="cid_"+parseInt(100*Math.random(),10),r=this;function o(){r.client.connect({onSuccess:i,onFailure:a,keepAliveInterval:30,useSSL:!0,timeout:3})}function i(){logger.log("pubdefend:: ws Connected"),r.client.subscribe(r.N,{qos:1}),m(e.p.l,"Connected")}function a(n){logger.log("Connect failed:"+n.errorMessage)}return r.N="test",r.client=new Paho.MQTT.Client(n,t),r.client.onMessageArrived=function(n){},r.client.onConnectionLost=function(n){0!==n.errorCode&&(logger.log("Connection lost:"+n.errorMessage),o())},o(),r.R=function(n,e,t,o){var i=function(n,e,t,r){var o=new Paho.MQTT.Message(e);return o.destinationName=n,o.qos=Number(t)||0,o.T=!!r,o}(n,e,t&&t.qos,t&&t.M);o&&(i.qos<1?setTimeout(o):(i.P=o,messageCache.push(i))),r.client.send(i)},r.L=function(n,e){if(n){var t=new Paho.MQTT.Message(n);t.destinationName=r.N,e&&setTimeout(e),r.client.send(t)}},r}n.H=y;var I,k=n.store;function x(n){g(k,"fp",l),g(k,"ho",function(){for(var n,e=[{key:"?",index:0},{key:"://",index:1},{key:"//",index:1},{key:"/",index:0},{key:":",index:0}],t=0,r=e.length,o=location.hostname;t<r;t++)o=(n=v(o,e[t].key,2)).length>1?n[e[t].index]:n[0];return o}());var e=atob(function(n){var e=document.querySelector(n);if(null!=e)return{id:e.getAttribute("pd-prop"),options:e.getAttribute("pubdefend-opts")||"{}"}}("[pd-prop]").id);g(k,"pu",JSON.parse(e));var r=function(){if(t){var n=window.navigator.userAgent.toLowerCase();switch(!0){case n.indexOf("edge")>-1:return"Edge (EdgeHtml)";case n.indexOf("edg")>-1:return"Edge Chromium";case n.indexOf("opr")>-1&&!!window.opr:return"opera";case n.indexOf("chrome")>-1&&!!window.chrome:return"chrome";case n.indexOf("trident")>-1:return"IE";case n.indexOf("firefox")>-1:return"Firefox";case n.indexOf("safari")>-1:return"Safari";case n.indexOf("Opera")||n.indexOf("OPR")>-1:return"Opera";default:return"other"}}}();return g(k,"br",r),g(k,"mo",o),n&&n("isReady"),"isReady"}t&&!r&&(n.debug&&window.console&&"function"==typeof console.log?window.logger={log:window.console.log.bind(console.log)}:window.logger={log:function(){}},I=function(){var t,r,o,i;logger.log("pubdefend:: init.."),t=function(n){n&&logger.log("pubdefend[g]::",n)},r=5,o=window.googletag,i=setInterval((function(){o&&o.apiReady&&(logger.log("pubdefend[g]:: apiReady (#"+r+")"),clearInterval(i),O(t)),r<=0&&clearInterval(i),r-=1}),100),x((function(t){var r,o,i;function a(t,r){var o,i;t&&(console.log("pubdefend["+t+" Listener]:: ws",n.state[e.p.l]),n.state[t]=!0,n.state[e.p.l]&&(o=t,i=r.detail.payload,o||(p[o]=i),console.log("pubdefend[EventQueue]::",t,r.detail.payload)),window.removeEventListener(e.p[t],a,!1))}logger.log("pubdefend::",t),n.state[e.p.l]=!1,function(n){var t=e.endpoints,r="https://"+t.u+"."+t.i+"/js/"+t.v,o=new XMLHttpRequest;o.open("HEAD",r,!0),o.onload=function(e){if(o.readyState===XMLHttpRequest.DONE){var t=o.status;if(0===t||t>=200&&t<400)return void(n&&n("false"))}},o.onerror=function(e){n&&n("true")},o.send(null)}((function(t){t&&(g(k,"ab",t),n.state[e.p.m]=!0,m(e.p.m,t))})),logger.log("pubdefend:: Loading ws"),r="https://"+e.endpoints.u+"."+e.endpoints.i+"/js/mqttws31.min.js",o=function(){logger.log("pubdefend[ws]:: ready"),_=new E},(i=document.createElement("script")).type="text/javascript",i.src=r,i.readyState?i.onreadystatechange=function(){var n=this.readyState;"loaded"!==n&&"complete"!==n||(i.onreadystatechange=null,o&&o())}:o&&(i.onload=o),document.getElementsByTagName("head")[0].appendChild(i),window.addEventListener(e.p.g,a.bind(null,e.p.g),!1),window.addEventListener(e.p.m,a.bind(null,e.p.m),!1),window.addEventListener(e.p.l,(function(t){logger.log("pubdefend[status]:: ws",n.state[e.p.l]),logger.info("pubdefend[ws Listener]::",t.detail.payload),logger.info("pubdefend[ws state]::",e.p.g,"isReady?",n.state.hasOwnProperty(e.p.g)),logger.info("pubdefend[ws staet]::",e.p.m,"isReady?",n.state.hasOwnProperty(e.p.m)),logger.table(n.state),n.state[e.p.l]=!0,logger.log(y()),_.L(JSON.stringify(y(!0)))}),!0)}))},"interactive"===document.readyState||"complete"===document.readyState?setTimeout(I,0):document.addEventListener("DOMContentLoaded",I))}();
