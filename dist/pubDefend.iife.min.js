!function(){"use strict";var n=window.pubDefend||window.pubdefend||{};n.state={},n.store={},n.t=[],n.o=[];var e={i:"pubdefend.com",u:"c",l:"ws",v:"ad_banner.js"},t={l:"___pd_ws",p:"___pd_gt",g:"___pd_ab"};var r="undefined"!=typeof window,o=r&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),i=(r&&document.createElement("p"),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent));function a(n){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function u(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],r=!0,o=!1,i=void 0;try{for(var a,u=n[Symbol.iterator]();!(r=(a=u.next()).done)&&(t.push(a.value),!e||t.length!==e);r=!0);}catch(n){o=!0,i=n}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return t}(n,e)||c(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(n,e){if(n){if("string"==typeof n)return d(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(n,e):void 0}}function d(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var f=Object.entries?Object.entries:function(n){return Object.keys(n).reduce((function(e,t){return e.push([t,n[t]]),e}),[])};function l(n){for(var e,t,r,o=3&n.length,i=n.length-o,a=3432918353,u=461845907,c=0;c<i;c++)r=255&n.charCodeAt(c)|(255&n.charCodeAt(++c))<<8|(255&n.charCodeAt(++c))<<16|(255&n.charCodeAt(++c))<<24,++c,e=27492+(65535&(t=5*(65535&(e=(e^=r=(65535&(r=(r=(65535&r)*a+(((r>>>16)*a&65535)<<16)&4294967295)<<15|r>>>17))*u+(((r>>>16)*u&65535)<<16)&4294967295)<<13|e>>>19))+((5*(e>>>16)&65535)<<16)&4294967295))+((58964+(t>>>16)&65535)<<16);var d=i-1;switch(r=0,o){case 3:r^=(255&n.charCodeAt(d+2))<<16;break;case 2:r^=(255&n.charCodeAt(d+1))<<8;break;case 1:r^=255&n.charCodeAt(d)}return e^=r=(65535&(r=(r=(65535&r)*a+(((r>>>16)*a&65535)<<16)&4294967295)<<15|r>>>17))*u+(((r>>>16)*u&65535)<<16)&4294967295,e^=n.length,e=2246822507*(65535&(e^=e>>>16))+((2246822507*(e>>>16)&65535)<<16)&4294967295,e=3266489909*(65535&(e^=e>>>13))+((3266489909*(e>>>16)&65535)<<16)&4294967295,(e^=e>>>16)>>>0}var s=function(n,e){var t=window,r=t.screen,o=t.userAgent,i=t.language,a=t.languages,c=t.platform,d=t.hardwareConcurrency,s=t.deviceMemory,w=r.colorDepth,v=r.availHeight,p=r.availWidth,g=f(t.navigator.plugins).map((function(n){return u(n,2)[1].name})),m=(new Date).getTimezoneOffset(),y=Intl.DateTimeFormat().resolvedOptions().timeZone,b="ontouchstart"in window,h=function(){try{var n=document.createElement("canvas"),e=n.getContext("2d");return e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",4,17),n.toDataURL()}catch(n){return n}}(),S=window.doNotTrack||navigator.doNotTrack||navigator.msDoNotTrack||"m"in window.external?!("1"!=window.doNotTrack&&"yes"!=navigator.doNotTrack&&"1"!=navigator.doNotTrack&&"1"!=navigator.msDoNotTrack&&!window.external.m()):void 0,O=JSON.stringify({platform:c,hardwareConcurrency:d,deviceMemory:s,colorDepth:w,availWidth:p,availHeight:v,h:b,canvas:h}),_=JSON.stringify({userAgent:o,language:i,languages:a,platform:c,hardwareConcurrency:d,deviceMemory:s,plugins:g,colorDepth:w,availWidth:p,availHeight:v,S:m,O:y,h:b,canvas:h,doNotTrack:S}),j=l(O)+"."+l(_);if(!e)return j;e(j)}(),w=function(n){return"object"===a(n)&&function(n){return null!=n}(n)&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof String)&&!(n instanceof Number)};function v(n,e,t){var r=n.split(e);return r.slice(0,t-1).concat(r.length>=t?r.slice(t-1).join(e):[])}function p(n){if(n&&document.getElementById("log")){var e=document.createElement("li");e.className="text-small font-normal",e.style.cssText="color: #99b8fd";var t=document.createTextNode(n);e.appendChild(t),document.getElementById("log").appendChild(e)}}var g=n.t;function m(n,e,t){if(w(n)&&e&&0!==e.length&&t&&0!==t.length)if(n[e]=t,w(t)){var r,o=function(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=c(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return a=n.done,n},e:function(n){u=!0,i=n},f:function(){try{a||null==t.return||t.return()}finally{if(u)throw i}}}}(f(t));try{for(o.s();!(r=o.n()).done;){var i=u(r.value,2);p(e+"::"+i[0]+": "+i[1])}}catch(n){o.e(n)}finally{o.f()}}else p(e+": "+t)}function y(e){var t=n.store,r=JSON.stringify(t);return e?btoa(r):t}function b(n,e){if(n){e=e||"none";var t,r=n;try{t=new CustomEvent(r,{detail:{payload:e}})}catch(n){(t=document.createEvent("CustomEvent")).initCustomEvent(r,!1,!1,{payload:e})}window.dispatchEvent(t)}}function h(e){var r,o;e.type&&(logger.log("pubdefend ["+e.type+" Listener]:: ws",n.state[t.l]),n.state[e.type]=!0,n.state[t.l]&&(r=e.type,o=e.detail.payload,r&&o&&(g[r]=o),logger.log("pubdefend [EventQueue]::",e.type,e.detail.payload),ws._(JSON.stringify(y(!1)))),window.removeEventListener(e.type,h))}var S={j:function(n){var e,t=[];if(!n||!n.length)return t;for(e=0;e<n.length;e++)t.push(n[e]);return t},find:function(n){if(!document.querySelectorAll||!n)return[];var e=document.querySelectorAll(n);return this.j(e)},A:function(n){if(!n||!n.length)return[];var e,t,r=[];for(e=0;e<n.length;e++)t=this.find(n[e]),r=r.concat(t);return r=this.C(r)},I:function(n,e){if(!n||!e||!n.getElementsByTagName)return[];var t=n.getElementsByTagName(e);return this.j(t)}};var O,_=n.store,j=0,A=!1;function E(n){var e=n.slot,r=e.getSlotElementId();!function(n){if(!n)return!1;function e(n,e){return window.getComputedStyle?document.defaultView.getComputedStyle(n,null)[e]:n.currentStyle?n.currentStyle[e]:void 0}"0"!==e(n,"opacity")&&"none"!==e(n,"display")&&e(n,"visibility")}(document.getElementById(r));if(n.isEmpty,n.size,logger.log("pubdefend [g]:: Slot",e.getSlotElementId(),"finished rendering."),!A){var o=S.find('div[id*="google_ad"]');m(_,"grs",o.length),b(t.p,o.length)}A=!0}function C(){var n="wss://"+e.l+"."+e.i+"/ws",r="cid_"+parseInt(100*Math.random(),10),o=this;function i(){o.client.connect({onSuccess:a,onFailure:u,keepAliveInterval:30,useSSL:!0,timeout:3})}function a(){o.client.subscribe(o.k,{qos:1}),b(t.l,"Connected")}function u(n){logger.log("Connect failed:"+n.errorMessage)}return o.k="test",o.client=new Paho.MQTT.Client(n,r),o.client.onMessageArrived=function(n){},o.client.onConnectionLost=function(n){0!==n.errorCode&&(logger.log("Connection lost:"+n.errorMessage),i())},i(),o.N=function(n,e,t,r){var i=function(n,e,t,r){var o=new Paho.MQTT.Message(e);return o.destinationName=n,o.qos=Number(t)||0,o.R=!!r,o}(n,e,t&&t.qos,t&&t.T);r&&(i.qos<1?setTimeout(r):(i.M=r,messageCache.push(i))),o.client.send(i)},o._=function(n,e){if(n){var t=new Paho.MQTT.Message(n);t.destinationName=o.k,e&&setTimeout(e),o.client.send(t),logger.log("pubdefend [ws]:: published")}},o}n.P=y;var I,k=n.store;function x(n){m(k,"fp",s),m(k,"hos",function(){for(var n,e=[{key:"?",index:0},{key:"://",index:1},{key:"//",index:1},{key:"/",index:0},{key:":",index:0}],t=0,r=e.length,o=location.hostname;t<r;t++)o=(n=v(o,e[t].key,2)).length>1?n[e[t].index]:n[0];return o}());var e=atob(function(n){var e=document.querySelector(n);if(null!=e)return{id:e.getAttribute("pd-prop"),options:e.getAttribute("pubdefend-opts")||"{}"}}("[pd-prop]").id);m(k,"pub",JSON.parse(e)),m(k,"sid",l((new Date).getTime().toString().concat(performance.now())));var t=function(){if(r){var n=window.navigator.userAgent.toLowerCase();switch(!0){case n.indexOf("edge")>-1:return"Edge (EdgeHtml)";case n.indexOf("edg")>-1:return"Edge Chromium";case n.indexOf("opr")>-1&&!!window.opr:return"opera";case n.indexOf("chrome")>-1&&!!window.chrome:return"chrome";case n.indexOf("trident")>-1:return"IE";case n.indexOf("firefox")>-1:return"Firefox";case n.indexOf("safari")>-1:return"Safari";case n.indexOf("Opera")||n.indexOf("OPR")>-1:return"Opera";default:return"other"}}}();return m(k,"brw",t),m(k,"mob",i),n&&n("Ready"),"isReady"}function N(n){var e=5,t=window.googletag,r=setInterval((function(){t&&t.apiReady&&(logger.log("pubdefend [g]:: Ready (#"+e+")"),clearInterval(r),function(n){j=window.googletag.pubads().getSlots().map((function(n){return{id:n.getSlotElementId()}})),m(_,"gds",j.length),logger.log("pubdefend [g]:: slots count:",j),window.googletag.pubads().addEventListener("slotRenderEnded",E,!1),n&&n("listen")}(n)),e<=0&&clearInterval(r),e-=1}),100)}r&&!o&&(n.debug&&window.console&&"function"==typeof console.log?window.logger={log:window.console.log.bind(console.log)}:window.logger=function(){},I=function(){logger.log("pubdefend:: init.."),N((function(n){n&&logger.log("pubdefend [g]::",n)})),x((function(r){var o,i,a,u,c,d,f;logger.log("pubdefend::",r),n.state[t.l]=!1,o=function(e){e&&(m(k,"ab",e),n.state[t.g]=!0,b(t.g,e))},a="https://"+(i=e).u+"."+i.i+"/js/"+i.v,(u=new XMLHttpRequest).open("HEAD",a,!0),u.onload=function(n){if(u.readyState===XMLHttpRequest.DONE){var e=u.status;if(0===e||e>=200&&e<400)return void(o&&o("false"))}},u.onerror=function(n){o&&o("true")},u.send(null),logger.log("pubdefend[ws]:: init.."),c="https://"+e.u+"."+e.i+"/js/mqttws31.min.js",d=function(){logger.log("pubdefend [ws]:: ready"),O=new C},(f=document.createElement("script")).type="text/javascript",f.src=c,f.readyState?f.onreadystatechange=function(){var n=this.readyState;"loaded"!==n&&"complete"!==n||(f.onreadystatechange=null,d&&d())}:d&&(f.onload=d),document.getElementsByTagName("head")[0].appendChild(f),window.addEventListener(t.p,h),window.addEventListener(t.g,h),window.addEventListener(t.l,(function e(r){logger.log("pubdefend [ws Listener]::",r.detail.payload),logger.log("pubdefend [ws state]::",t.p,"isReady?",n.state.hasOwnProperty(t.p)),logger.log("pubdefend [ws state]::",t.g,"isReady?",n.state.hasOwnProperty(t.g)),n.state[t.l]=!0,logger.log(y()),O._(JSON.stringify(y(!1))),window.removeEventListener(t.l,e)}))}))},"interactive"===document.readyState||"complete"===document.readyState?setTimeout(I,0):document.addEventListener("DOMContentLoaded",I))}();
