/* pubdefend v0.01 */
!function(){"use strict";var n=window.pubDefend||window.pubdefend||{};n.debug=!0,n.store={},n.t=[],n.o=[],n.domain="sponser.co.il";var e="_pbdfndEvents",t={domain:"pubdefend.com",i:"c",u:"ws",l:"ad_banner.js"};const o="undefined"!=typeof window,r=o&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),i=(o&&document.createElement("p"),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent));var a=Object.entries?Object.entries:function(n){return Object.keys(n).reduce((function(e,t){return e.push([t,n[t]]),e}),[])};var c=function(n,e){var t=window,o=t.screen,r=t.userAgent,i=t.language,c=t.languages,u=t.platform,d=t.hardwareConcurrency,s=t.deviceMemory,f=o.colorDepth,l=o.availHeight,v=o.availWidth,p=a(t.navigator.plugins).map((([,n])=>n.name)),w=(new Date).getTimezoneOffset(),g=Intl.DateTimeFormat().resolvedOptions().timeZone,m="ontouchstart"in window,h=function(){try{var n=document.createElement("canvas"),e=n.getContext("2d");return e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",4,17),n.toDataURL()}catch(n){return n}}(),b=window.doNotTrack||navigator.doNotTrack||navigator.msDoNotTrack||"v"in window.external?!("1"!=window.doNotTrack&&"yes"!=navigator.doNotTrack&&"1"!=navigator.doNotTrack&&"1"!=navigator.msDoNotTrack&&!window.external.v()):void 0,y=function(n){var e=3&n.length,t=n.length-e,o=3432918353,r=461845907;let i,a,c;for(let e=0;e<t;e++)c=255&n.charCodeAt(e)|(255&n.charCodeAt(++e))<<8|(255&n.charCodeAt(++e))<<16|(255&n.charCodeAt(++e))<<24,++e,c=(65535&c)*o+(((c>>>16)*o&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*r+(((c>>>16)*r&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,a=5*(65535&i)+((5*(i>>>16)&65535)<<16)&4294967295,i=27492+(65535&a)+((58964+(a>>>16)&65535)<<16);var u=t-1;switch(c=0,e){case 3:c^=(255&n.charCodeAt(u+2))<<16;break;case 2:c^=(255&n.charCodeAt(u+1))<<8;break;case 1:c^=255&n.charCodeAt(u)}return c=(65535&c)*o+(((c>>>16)*o&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*r+(((c>>>16)*r&65535)<<16)&4294967295,i^=c,i^=n.length,i^=i>>>16,i=2246822507*(65535&i)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(65535&i)+((3266489909*(i>>>16)&65535)<<16)&4294967295,i^=i>>>16,i>>>0}(n?JSON.stringify({platform:u,hardwareConcurrency:d,deviceMemory:s,colorDepth:f,availWidth:v,availHeight:l,p:m,canvas:h}):JSON.stringify({userAgent:r,language:i,languages:c,platform:u,hardwareConcurrency:d,deviceMemory:s,plugins:p,colorDepth:f,availWidth:v,availHeight:l,g:w,m:g,p:m,canvas:h,doNotTrack:b}));if(!e)return y;e(y)},u=c(!0),d=c(!1);const s=function(n){return"object"==typeof n&&(n=>null!=n)(n)&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof String)&&!(n instanceof Number)};function f(n,e,t){var o=n.split(e);return o.slice(0,t-1).concat(o.length>=t?o.slice(t-1).join(e):[])}var l=function(n){let e,t,o=n+"=",r=document.cookie.split(";");for(e=0;e<r.length;e++){for(t=r[e];" "===t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(o))return unescape(t.substring(o.length,t.length))}return null};function v(n){if(n&&document.getElementById("log")){var e=document.createElement("li");e.className="text-small font-normal",e.style.cssText="color: #99b8fd";var t=document.createTextNode(n);e.appendChild(t),document.getElementById("log").appendChild(e)}}function p(n,e,t){if(s(n))if(n.hasOwnProperty(e)||(n[e]=t),n[e]=t,s(t))for(const[n,o]of a(t))v(e+"::"+n+": "+o);else v(e+": "+t)}function w(e){var t=n.store,o=JSON.stringify(t);return e?btoa(o):t}var g={h:function(n){var e,t=[];if(!n||!n.length)return t;for(e=0;e<n.length;e++)t.push(n[e]);return t},find:function(n){if(!document.querySelectorAll||!n)return[];var e=document.querySelectorAll(n);return this.h(e)},k:function(n){if(!n||!n.length)return[];var e,t,o=[];for(e=0;e<n.length;e++)t=this.find(n[e]),o=o.concat(t);return o=this.O(o)},S:function(n,e){if(!n||!e||!n.getElementsByTagName)return[];var t=n.getElementsByTagName(e);return this.h(t)}};var m=n.store,h=0,b=!1;var y=function(n,e){var t=e.slot,o=t.getSlotElementId();!function(n){if(!n)return!1;function e(n,e){return window.getComputedStyle?document.defaultView.getComputedStyle(n,null)[e]:n.currentStyle?n.currentStyle[e]:void 0}"0"!==e(n,"opacity")&&"none"!==e(n,"display")&&e(n,"visibility")}(document.getElementById(o));if(console.log("googaltag Slot",t.getSlotElementId(),"finished rendering."),!b){var r=g.find('div[id*="google_ad"]');p(m,"gtag_impr",r.length),n&&n(r)}b=!0},k=function(n){},O=t;function S(){var n="cid_"+parseInt(100*Math.random(),10),e=this;function t(){e.client.connect({onSuccess:o,onFailure:r,keepAliveInterval:30,useSSL:!0,timeout:3})}function o(){console.log("pubdefend:: ws Connected"),e.client.subscribe(e.C,{qos:1}),function(n,e){if(!n)return;var t,o=e||"none";let r=n;try{t=new CustomEvent(r,{detail:{data:o}})}catch(n){(t=document.createEvent("CustomEvent")).initCustomEvent(r,!1,!1,{N:instance})}window.dispatchEvent(t)}("wsLoaded")}function r(n){console.log("Connect failed:"+n.errorMessage)}return e.C="test",e.client=new Paho.MQTT.Client("wss://ws.pubdefend.com/ws",n),e.client.onMessageArrived=function(n){},e.client.onConnectionLost=function(n){0!==n.errorCode&&(console.log("Connection lost:"+n.errorMessage),t())},t(),e.j=function(n,t,o,r){var i=function(n,e,t,o){var r=new Paho.MQTT.Message(e);return r.destinationName=n,r.qos=Number(t)||0,r.M=!!o,r}(n,t,o&&o.qos,o&&o.P);r&&(i.qos<1?setTimeout(r):(i.R=r,messageCache.push(i))),e.client.send(i)},e.T=function(n,t){if(n){var o=new Paho.MQTT.Message(n);o.destinationName=e.C,t&&setTimeout(t),e.client.send(o)}},e}n.A=function(){var n={},t=l(e),o=JSON.parse(t);for(let e in o)n[o[e].I]=o[e].L;console.log(n),console.log(btoa(n))},n.H=w;var x,C=n.store;function E(e){!function(n){var e=5,t=window.googletag,o=setInterval((function(){console.log(e),t&&t.apiReady&&(console.log("googaltag apiReady:",t&&t.apiReady),clearInterval(o),function(n){var e=window.googletag.pubads();h=e.getSlots().length,p(m,"gtag_slots",h),m._?n&&n("blocked"):(console.debug("pubdefend:: No adblocker detected. listen to gtag"),e.addEventListener("slotRenderEnded",y.bind(null,k),!1)),console.log("googaltag slots:",h)}(n)),e<=0&&clearInterval(o),e-=1}),300)}((function(n){console.log("gtag::",n)}));var t={};t.hardware=u,t.extended=d,p(C,"fingerprint",t);var r={};r.hostname=function(n){for(var e,t=[{key:"?",index:0},{key:"://",index:1},{key:"//",index:1},{key:"/",index:0},{key:":",index:0}],o=0,r=t.length,i=n;o<r;o++)i=(e=f(i,t[o].key,2)).length>1?e[t[o].index]:e[0];return i}(location.hostname),r.domain=n.domain,r.sameSite=-1!==r.hostname.indexOf(r.domain.toString()),r.pubid=function(n){const e=document.querySelector(n);if(null==e)return;return{id:e.getAttribute("pub-defend-property"),options:e.getAttribute("pubdefend-opts")||"{}"}}("[pub-defend-property]").id,p(C,"publisher",r);var a=function(){if(o){var n=window.navigator.userAgent.toLowerCase();switch(!0){case n.indexOf("edge")>-1:return"Edge (EdgeHtml)";case n.indexOf("edg")>-1:return"Edge Chromium";case n.indexOf("opr")>-1&&!!window.opr:return"opera";case n.indexOf("chrome")>-1&&!!window.chrome:return"chrome";case n.indexOf("trident")>-1:return"IE";case n.indexOf("firefox")>-1:return"Firefox";case n.indexOf("safari")>-1:return"Safari";case n.indexOf("Opera")||n.indexOf("OPR")>-1:return"Opera";default:return"other"}}}();p(C,"browser",a),p(C,"isMobile",i);!function(n){var e="https://"+O.i+"."+O.domain+"/js/"+O.l,t=new XMLHttpRequest;t.open("HEAD",e,!0),t.onload=function(e){if(t.readyState===XMLHttpRequest.DONE){var o=t.status;if(0===o||o>=200&&o<400)return void(n&&n(!1))}},t.onerror=function(e){n&&n(!0)},t.send(null)}((function(n){p(C,"blocked",n)}));return e&&e("isReady"),"isReady"}o&&!r&&(x=function(){console.log("pubdefend:: init.."),E((function(n){var e,o,r;console.log("pubdefend::",n),console.log("pubdefend:: Loading paho lib"),e="https://"+t.i+"."+t.domain+"/js/mqttws31.min.js",o=function(){console.log("pubdefend:: paho lib ready");var n=new S;window.addEventListener("wsLoaded",(function(e){console.log("listenToWs",e.detail),n.T(JSON.stringify(w()))}),!0)},(r=document.createElement("script")).type="text/javascript",r.src=e,r.readyState?r.onreadystatechange=function(){var n=this.readyState;"loaded"!==n&&"complete"!==n||(r.onreadystatechange=null,o&&o())}:o&&(r.onload=o),document.getElementsByTagName("head")[0].appendChild(r)}))},"interactive"===document.readyState||"complete"===document.readyState?setTimeout(x,0):document.addEventListener("DOMContentLoaded",x))}();
